name: vcards
graphs:
  start:
    - type: IntRange
      from: 1
      to: 1000
      output: e
      joinKey: joinkey1
      streamTarget: read

  read:
    - type: ReadFile
      inputFile: "bible.txt"
      output: line

    - type: wordcount
      line: "{line}"
      put: wordcount

    - type: joinsingle
      joinKey: "{joinkey1}"
      key: "{wordcount}"
      output: wordcounts
      joinTarget: finished


  finished:
    - type: mergecounts
      maps: "{wordcounts}"
      output: all

    - type: echo
      log: "{{all}@god}"

